%% -*-: erlang -*-

case {os:getenv("GITHUB_ACTIONS"), os:getenv("GITHUB_TOKEN")} of
  {"true", Token} when is_list(Token) ->
    EventPath = os:getenv("GITHUB_EVENT_PATH"),
    io:format("~p~n", [EventPath]),
    {ok, EventFile} = file:read_file(EventPath),
    io:format("~s~n", [EventFile]),

    io:format("All Env: ~p~n", [os:getenv()]),

    JobId = os:getenv("GITHUB_RUN_ID"),
    [{coveralls_service_job_id, JobId},
     {coveralls_repo_token, Token},
     {coveralls_coverdata, "_build/test/cover/*.coverdata"},
     {coveralls_service_name , "github"} | CONFIG];
  _ ->
    CONFIG
end.
